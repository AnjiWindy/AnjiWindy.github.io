<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vuex | Anji博客</title>
    <meta name="description" content="Welcome to my blog ">
    
    
    <link rel="preload" href="/assets/css/0.styles.f2124281.css" as="style"><link rel="preload" href="/assets/js/app.d2db35b1.js" as="script"><link rel="preload" href="/assets/js/2.3d65a9bd.js" as="script"><link rel="preload" href="/assets/js/6.7222ed7b.js" as="script"><link rel="prefetch" href="/assets/js/10.7e1a2abf.js"><link rel="prefetch" href="/assets/js/11.b67926d6.js"><link rel="prefetch" href="/assets/js/12.1acbb188.js"><link rel="prefetch" href="/assets/js/13.3042c592.js"><link rel="prefetch" href="/assets/js/14.35ddf8b9.js"><link rel="prefetch" href="/assets/js/15.4d8585d4.js"><link rel="prefetch" href="/assets/js/16.976ac738.js"><link rel="prefetch" href="/assets/js/17.403f7719.js"><link rel="prefetch" href="/assets/js/18.92c074ba.js"><link rel="prefetch" href="/assets/js/19.979680c0.js"><link rel="prefetch" href="/assets/js/20.12c24125.js"><link rel="prefetch" href="/assets/js/21.75236644.js"><link rel="prefetch" href="/assets/js/22.99db2e15.js"><link rel="prefetch" href="/assets/js/23.b5999731.js"><link rel="prefetch" href="/assets/js/24.0d1a4624.js"><link rel="prefetch" href="/assets/js/25.1524be97.js"><link rel="prefetch" href="/assets/js/26.f9d1c2bf.js"><link rel="prefetch" href="/assets/js/27.13235d74.js"><link rel="prefetch" href="/assets/js/28.8e5be585.js"><link rel="prefetch" href="/assets/js/29.49595657.js"><link rel="prefetch" href="/assets/js/3.24073063.js"><link rel="prefetch" href="/assets/js/30.01cb4de1.js"><link rel="prefetch" href="/assets/js/4.57ba7ae3.js"><link rel="prefetch" href="/assets/js/5.838622a9.js"><link rel="prefetch" href="/assets/js/7.918a646b.js"><link rel="prefetch" href="/assets/js/8.564e1d40.js"><link rel="prefetch" href="/assets/js/9.6b6163c2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f2124281.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Anji博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>入门</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ajax</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>jQuery</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>vue</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vue/MVVM/" class="sidebar-link">MVVM框架模式</a></li><li><a href="/vue/bind/" class="sidebar-link">vue双向数据绑定</a></li><li><a href="/vue/axios/" class="sidebar-link">axios请求数据</a></li><li><a href="/vue/vuex/" class="active sidebar-link">vuex</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vue/ui/" class="sidebar-link">常用的ui库</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="vuex-是什么？"><a href="#vuex-是什么？" aria-hidden="true" class="header-anchor">#</a> <strong>Vuex 是什么？</strong></h3> <p>1.借鉴 了 Flux、Redux、The Elm Architecture 。</p> <p>2.Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。</p> <p>3.它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化。</p> <p>4.Vuex 也集成到 Vue 的官方调试工具。</p> <p>5.一个 Vuex 应用的核心是 store（仓库，一个容器），store 包含着你的应用中大部分的状态(state)。</p> <h3 id="基础的使用步骤："><a href="#基础的使用步骤：" aria-hidden="true" class="header-anchor">#</a> <strong>基础的使用步骤</strong>：</h3> <p>1、下载安装：npm install vuex --save</p> <p>2、创建一个存储数据的仓库，为了方便管理我们可以在 src 目录下创建一个 store 目录，然后在里面创建数据仓库文件 index.js</p> <p>3、我们需要将该数据仓库 import 到 main.js 中使关键字“<strong>store</strong>”成为全局能使用的 API</p> <p>4、由于我们在 main.js 将 store 加载到了 new Vue 实例中，因此我们要在组件中调用数据仓库中存储的数据</p> <h3 id="数据流向图："><a href="#数据流向图：" aria-hidden="true" class="header-anchor">#</a> <strong>数据流向图：</strong></h3> <p><img src="/assets/img/untitled.a9434cf5.png" alt="An image"></p> <h3 id="vuex-store-实例"><a href="#vuex-store-实例" aria-hidden="true" class="header-anchor">#</a> <strong>vuex store 实例</strong></h3> <p>每一个 Vuex 应用的核心就是 store（仓库），这里存放了应用中的大部分状态 stage，操作状态的 mutations，触发 mutations 的 actions。</p> <h3 id="store-实例的生成"><a href="#store-实例的生成" aria-hidden="true" class="header-anchor">#</a> <strong>store 实例的生成</strong></h3> <p>与生成 vue 实例一样，同样是调用一个构造函数 Vuex.Store,并传入一个 option 对象，从而生成一个 store 实例。这个实例包含了应用的状态，和改变应用状态的方法。</p> <p><img src="/assets/img/untitled1.ac8d5dd4.png" alt="An image"></p> <p><strong>但是 store 实例尽管提供了改变状态的方法，它本身是不改变状态的。改变状态的源头来自组件和生命周期的钩子函数。 在组件中，使用计算属性来读取应用的状态，通过 action——&gt;mutation——&gt;state 来改变应用的 state。另外，并不是说应用的所有状态都应该放到 vuex 的 state 中，state 主要放用于共享的，或者应用级别的状态</strong></p> <p><strong>1、State</strong></p> <p>vuex 中的数据源，我们需要保存的数据就保存在这里，可以在页面通过 this.$store.state 来获取我们定义的数据</p> <p><strong>2.Getters</strong></p> <p>Getter 相当于 vue 中的 computed 计算属性，getter 的返回值会根据它的依赖被缓存起来，且只有当它的依赖值发生了改变才会被重新计算，这里我们可以通过定义 vuex 的 Getter 来获取，Getters 可以用于监听、state 中的值的变化，返回计算后的结果</p> <p><strong>3.Mutations</strong></p> <p>如果需要修改 store 中的值唯一的方法就是提交 mutation 来修改</p> <p><strong>4.Actions</strong></p> <p>官方并不建议我们这样直接去修改 store 里面的值，而是让我们去提交一个 actions，在 actions 中提交 mutation 再去修改状态值</p> <h3 id="vuex-的使用场景"><a href="#vuex-的使用场景" aria-hidden="true" class="header-anchor">#</a> <strong>vuex 的使用场景</strong></h3> <p>1.不适用：小型简单应用，用 Vuex 是繁琐冗余的，更适合使用简单的 store 模式。</p> <p>2. 适用于：中大型单页应用，你可能会考虑如何把组件的共享状态抽取出来，以一个全局单例模式管理，不管在哪个组件，都能获取状态/触发行为，解决问题如下：</p> <p>① 多个视图使用于同一状态：</p> <p>传参的方法对于多层嵌套的组件将会非常繁琐，并且对于兄弟组件间的状态传递无能为力</p> <p>② 不同视图需要变更同一状态：</p> <p>采用父子组件直接引用或者通过事件来变更和同步状态的多份拷贝，通常会导致无法维护的代码</p> <h3 id="辅助函数"><a href="#辅助函数" aria-hidden="true" class="header-anchor">#</a> 辅助函数</h3> <h4 id="mapstate"><a href="#mapstate" aria-hidden="true" class="header-anchor">#</a> mapState</h4> <p>引入</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> mapState <span class="token punctuation">}</span> <span class="token keyword">from</span> 'vuex
</code></pre></div><p>3 种用法</p> <p>---对象</p> <p>如果使用箭头函数，当 vuex 的 state 和当前组件的 state，含有相同的变量名称时，this 获取的是 vuex 中的变量，而不是局部变量</p> <div class="language-js extra-class"><pre class="language-js"><code>computed<span class="token punctuation">:</span> <span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
<span class="token comment">// 箭头函数 count: state =&gt; state.count,</span>
<span class="token comment">// 这里为了能够使用this获取局部变量localCount，必须使用常规函数 countPlusLocalState (state) {</span>
<span class="token keyword">return</span> state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>localCount
<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>---数组
当映射的计算属性的名称与 state 的子节点名称相同时，我们也可以给 mapState 传一个字符串数组。</p> <div class="language-js extra-class"><pre class="language-js"><code>computed<span class="token punctuation">:</span> <span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token comment">// 映射 this.count 为 store.state.count 'count'])</span>
</code></pre></div><p>---对象展开运算符
mapState 函数返回的是一个对象。如果需要将它与局部计算属性混合使用，通常我们需要一个工具函数将多个对象合并为一个，以使我们可以将最终对象传给 computed 属性。</p> <div class="language-js extra-class"><pre class="language-js"><code>computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">localComputed</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token operator">...</span><span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
也可以使用<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">...mapState([])</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>但前提是映射的计算属性的名称与state的子节点名称相同，如果state在vuex的modules中，则不成功。
</code></pre></div><h4 id="mapgetters"><a href="#mapgetters" aria-hidden="true" class="header-anchor">#</a> mapGetters</h4> <p>mapGetters 将 store 中的 getter 映射到局部计算属性</p> <div class="language-js extra-class"><pre class="language-js"><code>computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span><span class="token function">mapGetters</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token string">'oneGetter'</span><span class="token punctuation">,</span>
    <span class="token string">'anotherGetter'</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="mapmutations"><a href="#mapmutations" aria-hidden="true" class="header-anchor">#</a> mapMutations</h4> <p>使用 mapMutations 辅助函数将组件中的 methods 映射为 store.commit 调用。</p> <div class="language-js extra-class"><pre class="language-js"><code>methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// 将this.tips映射成 this.$store.commit('tips')</span>
  <span class="token operator">...</span><span class="token function">mapMutations</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'tips'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="mapaction"><a href="#mapaction" aria-hidden="true" class="header-anchor">#</a> mapAction</h4> <p>使用 mapActions 辅助函数将组件的 methods 映射成 store.dispatch 调用</p> <div class="language-js extra-class"><pre class="language-js"><code>methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// 将this.tips映射成 this.$store.dispatch('tips')</span>
  <span class="token operator">...</span><span class="token function">mapActions</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'tips'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/vue/axios/" class="prev">
          axios请求数据
        </a></span> <span class="next"><a href="/vue/ui/">
          常用的ui库
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d2db35b1.js" defer></script><script src="/assets/js/2.3d65a9bd.js" defer></script><script src="/assets/js/6.7222ed7b.js" defer></script>
  </body>
</html>
